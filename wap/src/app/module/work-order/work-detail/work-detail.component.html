<div class="work-order-main">
  <header class="nav-box">
      <a class="nav-back" (click)="goback()"></a>
      {{activeDetail.title}}
  </header>
  <div class="work-order-detail">
    <section class="detail-box">
      <div class="detail-title">
        <ng-container *ngIf="detail.patrolPlan">
          {{detail.patrolPlan.name}}
        </ng-container>
        <ng-container *ngIf="detail.alarm">
          预警描述: {{detail.alarm.description}}
        </ng-container>
        <ng-container *ngIf="detail.fault">
          故障描述: {{detail.fault.description}}
        </ng-container>
      </div>
      <section class="detail-address">
        <ng-container *ngIf="detail.patrolPlan">
          巡检路线
        </ng-container>
        <ng-container *ngIf="detail.alarm">
          预警位置: {{detail.alarm.target.object.serialNumber}}
        </ng-container>
        <ng-container *ngIf="detail.fault">
          故障位置: {{detail.fault.target.object.serialNumber}}
        </ng-container>
      </section>
      <section class="detail-map"><span>查看地图</span></section>
      <section class="detail-info">
        <ng-container *ngIf="detail.patrolPlan">
          <p>指定巡检时间：<span class="p-text">{{detail.patrolPlan.createAt|date:'yyyy-MM-dd HH:mm:ss'}} - {{detail.finishAt|date:'yyyy-MM-dd HH:mm:ss'}}</span></p>
        </ng-container>
        <ng-container *ngIf="detail.alarm">
          <p>工单创建人：{{detail.creator.realName}}</p>
          <p>创建时间：{{detail.createAt|date:'yyyy-MM-dd HH:mm:ss'}}</p>
          <p>实际完成时间：{{detail.finishAt|date:'yyyy-MM-dd HH:mm:ss'}}</p>
          <p *ngIf='lastFeedback'>指定完成时间：{{lastFeedback.time|date:'yyyy-MM-dd HH:mm:ss'}}</p>
        </ng-container>
        <ng-container *ngIf="detail.fault">
          <p>工单创建人：{{detail.creator.realName}}</p>
          <p>创建时间：{{detail.createAt|date:'yyyy-MM-dd HH:mm:ss'}}</p>
          <p>指定完成时间：{{detail.finishAt|date:'yyyy-MM-dd HH:mm:ss'}}</p>
          <p *ngIf='lastFeedback'>实际完成时间：{{lastFeedback.time|date:'yyyy-MM-dd HH:mm:ss'}}</p>
        </ng-container>
        <p *ngIf='lastFeedback'>
          反馈信息： {{lastFeedback.action}}
        </p>
        <div class="img-box" *ngIf='lastFeedback && lastFeedback.photos'>
          反馈图片：
          <img *ngFor="let photo of lastFeedback.photos" [src]="getImg(photo)" alt="">
        </div>
      </section>
    </section>

    <div *ngIf="activeDetail.btn" (click)="detailEvent(activeDetail.btn.event)" class="detail-btn">{{activeDetail.btn.name}}</div>
  </div>
</div>